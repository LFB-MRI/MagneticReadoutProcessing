---
title: "Development of a permanent magnet characterisation framework for use in low-field MRI systems"
subtitle: "FH Aachen – University of Applied Sciences"
author: Marcel Ochsendorf
institute: Faculty of Electrical Enginnering and Information Technology - Information Systems Engineering
date: today
date-format: "dddd, [the] D[<sup style='font-size:65%;font-style:italic;'>th</sup>] [of] MMMM, YYYY"
embed-resources: false
format: coeos-revealjs
---

```{r}
#| include: false
sysfonts::font_add_google("Alegreya Sans", "Alegreya Sans", regular.wt = 300)
showtext::showtext_auto()
source("_extensions/mcanouil/coeos/setup-ggplot2-coeos.R")
```



## Introduction

## Lets build an MRI

## Aim of this Project




--- 

##  

<h1 class="r-fit-text" style="text-align: center;">MagneticReadoutProcessing</h1>

<p class="fragment">Provides and user-oriented **open** magnetic field data hardware and software framework:</p>
<br />
<p class="fragment">&#x2022; Harware support for several magnetic field sensors</p>
<br />
<p class="fragment">&#x2022; Ready to use data analysis pipelines</p>
<br />
<p class="fragment">&#x2022; Easy to integrate into existing projects</p>
<br />
<p class="fragment">&#x2022; Easy to extend</p>


<aside class="notes">
* dazu wurde das MRP framework erstellt
* welche die folgenden Probleme behen soll:
* viele derzeitigen magnetfeldmessungen in low field mrt bereich verwenden magentfeld sensoren
* datenanalyse pipelines sind identsisch bis auf einzelne algorithmen
* gemeinsame grundlage soll geschaffen werden um solche optimierungsalgorithmen verlgeichen zu können

</aside>


---

### Hardware Framework

Cheap and easy to construct sensors using consumer grade magnetic field sensors:
<br />
<p class="fragment">&#x2022; One software for most common digital magnetic field sensors</p>
<br />
<p class="fragment">&#x2022; Synchronised multi sensor setups</p>
<br />
<p class="fragment">&#x2022; Universal and interachangable magnet mount</p>
<br />
<p class="fragment">&#x2022; **Open** hardware designs</p>

<aside class="notes">
* es werden 8 von den günstigen sensoren verwendet
* diese werden in ähnlichen projketen verwendet
* Magnet mount für viele Magnetformen anpassbar
* ohne dass die sensor hardware geaendert werden muss
</aside>

---

### Hardware Framework

::: {.container}
:::: {.col}
<h4 style="text-align: center;">3D Rotational Sensor</h4>
::::
:::

::: {.container}
:::: {.col}
<img src="images/3D_sensor.png" alt="image" height="320px">
::::

:::: {.col}
<img src="images/3D_sensor_measurement.png" alt="image" height="320px" >
::::
:::

---

### Hardware Framework

::: {.container}
:::: {.col}
<h4 style="text-align: center;">1D Static Sensor</h4>
::::
:::

::: {.container}
:::: {.col}
<img src="images/1D_sensor.png" alt="image" height="320px">
::::

:::: {.col}
<img src="images/1D_sensor_measurement.png" alt="image" height="320px" >
::::
:::



---

### Software Framework

Allows rapid development of software analysation functions, without implementation of typical data processing pipelines needed by providing:

<br />
<p class="fragment">&#x2022; Expandable **open** datatypes for magnetic field data</p>
<br />
<p class="fragment">&#x2022; Prebuild analysis pipelines ready for user customisation</p>
<br />
<p class="fragment">&#x2022; Full online documentation, CI tested and user tutorials</p>

<aside class="notes">
* messdaten und meta-daten management
* integration zu magpylib, matlab, 
</aside>

---

### User Interaction Points

![](images/MRP_high_level_overview.png)

<aside class="notes">
* nutzer kann jeden punkt implementieren ohne die komplette pipelines zu implemtieren
* 
* dieses konzept wird im folgenden demonstriert an zwei usecases
</aside>

---

## Use Cases

Two pratical application of the framework will be shown using two examples:

<br />
<p class="fragment">&#x2022; Characterization of a *MM5603NJ* and *TLV493D* to measure background noise, temperature coefficients and linearity</p>
<br />
<p class="fragment">&#x2022; Usage of the chrakterised sensor for sorting permanent magnets and measure magnetic fields</p>


<aside class="notes">
* dazu wurde das entwicklete framework verwendet
* voll automatisiert
* diese sensoren als beispiel für die in anderen arbeiteten verwendeten sensoren
* diese wie TLV wurden nur anhand von Datenblatt chrakterisiert
* Ergebnisse werden bei der magnet chrakterisierung verwendet
</aside>
---



### Sensor Chraterisation Setup

![](images/Sensor_evaluation_setup_for_linearity_measurements.png)

<aside class="notes">
* vereinfachter aufbau
* sensorplatte zeigen
* gleiche befdinungen
* zweites set an sensoren
</aside>

---

### Chraterisation results : Noise

::: {.container}
:::: {.col}
<img src="images/eval/n_mmc.png" alt="image" >
::::

:::: {.col}
<img src="images/eval/n_tlv.png" alt="image" >
::::
:::

<aside class="notes">
* TLV abweichung 0.2C (bitsprüunge) => nicht für temperatur compensation zu nutzen
* TLV mehr als doppelt so hoch wie im datenblatt (12bit 4096/260mT)
* Ergebnisse mit einem zweiten set an sensoren verifiziert
* MMC im noise weit unter datenblatt
</aside>

---

### Chraterisation results : Temperature

::: {.container}
:::: {.col}
<img src="images/eval/t_mmc.png" alt="image" >
::::

:::: {.col}
<img src="images/eval/t_tlv.png" alt="image" >
::::
:::

<aside class="notes">
* Temperaturen wurden mit ref thermometer erstellt.
* TLV doppelt so steil liegt bei 5% jedoch im Datenblatt zum drift
</aside>


---

### Chraterisation results : Dynamic Range

::: {.container}
:::: {.col}
<img src="images/eval/dr_mmc.png" alt="image" >
::::

:::: {.col}
<img src="images/eval/dr_tlv.png" alt="image" >
::::
:::

<aside class="notes">
    
* DR am äußeren messbreich weiterhin gut
* gleiche aussehende abweichung weisst anfängliche fehler im messaufbau hin


</aside>

---

### Manget Sorting

![](images/magnet_sorting_pipeline.png)


1. Configure sensor and measurement parameters
2. Run measurement
3. Implement custom filter function
4. Run analysation pipeline using custom algorithm


<aside class="notes">

* Ziel: automatisierten Sortieren von Magneten um dann spätereinen Hallbach ring zu erstellen
* Diese Daten dann in optimierungsalgorithmen zu verwenden.
* Vordefinierte Pipeline verwendet
* Die X besten Magnete sollen anhand mittelwert sollen zurueckgegben werden
</aside>


---

#### Manget Sorting - DEMO MRP

* Simple installation using pip
* Commandline interface available system wide
* Compatible with Docker and CI pipelines

![](images/MRP.gif)

---

#### Manget Sorting - DEMO MRPCli

* Generate automated measurement using hardware sensors
* Save results to filesystem for later analysation

![](images/MRPCli.gif)



---

#### Manget Sorting - DEMO MRPUdpp

* Execution of pre-configured analysation and pipeline
* User implements filter algorithm only


![](images/MRPUdpp.gif)




---

## Conclusion

* The implemented framework was successfully used to automatically record and analyze measurement data
* Characterized sensors are only conditionally suitable for measuring low field MRI B0 fields
* Implementation of other sensor types required for a wider use of the implemented solution

<aside class="notes">
* dies liegt vorallem an dem Messbereich und Aufloesung
* implementierung von besonders analogen sensoren ist notwendig um die geforderten genauigkeiten von B0 feldern genauigkeiten zu vermessen

* verbreitung des frameworks durch integration in bestehende optimierungs projekte such as the MRIHallbachDesigner

</aside>




# 
<h1 class="r-fit-text" style="text-align: center;">Questions ?</h1>

<table>
<tr><td><p>[<img src="images/github-mark-white.png" alt="image" width="150" height="auto">](https://github.com/LFB-MRI/MagneticReadoutProcessing) </p></td><td><p>[<img src="images/researchgate.svg" alt="image" width="150" height="auto">](https://www.researchgate.net/publication/374388764_Development_of_a_permanent_magnet_characterisation_framework_for_use_in_low-field_MRI_systems) </p><td>[<img src="images/avatar.png" alt="image" width="150" height="auto">](https://marcelochsendorf.com)</td><td><p>[<img src="images/pypi.svg" alt="image" width="150" height="auto">](https://pypi.org/project/MagneticReadoutProcessing/) </p></td><td><p>[<img src="images/rtd.png" alt="image" width="150" height="auto">](https://magneticreadoutprocessing.readthedocs.io/en/latest/) </p></td></tr>
</table>
